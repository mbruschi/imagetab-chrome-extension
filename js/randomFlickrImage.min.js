var query="";var results_per_page="100";var image_generator={searchOnFlickrUrl:function(){return"https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=364295986c1e737da1baf1d60b64e985&tags="+encodeURIComponent(query)+"&sort=interestingness-desc&content_type=1&per_page="+results_per_page+"&format=rest"},requestImages:function(){var a=new XMLHttpRequest();a.open("GET",this.searchOnFlickrUrl(),true);a.onload=this.showPhotos.bind(this);a.send(null)},showPhotos:function(c){var a=c.target.responseXML.querySelectorAll("photo");var b=Math.floor(Math.random()*results_per_page);document.body.setAttribute("style","background-image: url("+this.constructImageUrl(a[b])+"); background-size: cover;");document.getElementById("imagelink").setAttribute("href",this.constructImageFlickrUrl(a[b]))},constructImageUrl:function(a){return"http://farm"+a.getAttribute("farm")+".static.flickr.com/"+a.getAttribute("server")+"/"+a.getAttribute("id")+"_"+a.getAttribute("secret")+"_b.jpg"},constructImageFlickrUrl:function(a){return"https://www.flickr.com/photos/"+a.getAttribute("owner")+"/"+a.getAttribute("id")}};document.addEventListener("DOMContentLoaded",function(){chrome.storage.sync.get({imagekeywords:"mountain"},function(a){query=a.imagekeywords;image_generator.requestImages()})});